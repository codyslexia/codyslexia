---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: graphql-gateway
  namespace: dev
spec:
  replicas: 1
  selector:
    matchLabels:
      app: codyslexia
      component: graphql-gateway
  template:
    metadata:
      labels:
        app: codyslexia
        component: graphql-gateway
    spec:
      imagePullSecrets:
        - name: github-registry
      containers:
        - name: graphql-gateway
          image: ghcr.io/codyslexia/graphql-gateway
          imagePullPolicy: IfNotPresent
          ports:
            - containerPort: 3000
              name: graphql-gateway
          env:
            - name: APP_NAME
              value: 'graphql-gateway'
            - name: PORT
              value: '3000'
            - name: ROUTER_AUTHORIZATION
              value: 'e1f4b876c8ae3233a10142e96a849b893e89e57d2619677593a3cb457cefbca90e9cb455c5e49d65a77f3e64a2a260f67f0ecaeafcef5037877787f7e0804e6c26a9407ab7c2ad62e92e4219ea765e3b06a2fe549b251f8197f69d6d3afe848d01b3841515dd7c68c6e992ade1a57a01e6ce2598a2bf367c1a93a8be9e79b39ce7ba512e1602b4e06df74c805b59b11a58db6d121a7774a07d85b8598077eafd3c4b7164cab327304a34c0adcab03e1981997dbea2304645270a00bf87d703165befeaaadce03a9a489c7e94e9a88bb2a5a3f308831c2b59fec43c6a078d4ece6c795df09ea9483f0c29b23e65e3909339b13e956354d8d7ba2ed24a7b0b117d'
            - name: USERS_SUBGRAPH_ROUTER_SECRET
              value: 'ldq2idOjYyxW3vZ+KyAHmIggJMLZAAeRmrPJEGKoSwbXHX3tBD72uMaiu5ZBbDAGnERMnKJRREW7HTe063c9AcN5ZgrQ9KkVbQpISLRtXsncUse9u4BHC14jRI6Uk3GPCaSCwCyNYHrrwiqpoHsawy3BpvxWJyalL4RyfJi6+lfe2iPhqW7gIeB9pFo6yP+iv9ZGt3pyjbqdjDMzdGfq9uaSOQMF5c40wByCcZ8FqHEcGZzXaTFmWziRrUXrmnuMuT0pLAZlssjSGl3xao8Ahbbrjlx/ESPs9uC0MSLpAkDIEk4qsB8aLg9dtVKzTapYipnR21Vs1oVHxLvCBnPuRg=='
            - name: PROJECTS_SUBGRAPH_ROUTER_SECRET
              value: '766d4e94bf7335bd96c973c14bbefee58c47ddf4f4a2577f3d4e9856e79410ea33ccd89b1cbcbba08c43f599f8a33218489141089aa45593d397fd52c5957d0c0b9e0bad72fe8f3e657161c94a735a8ac57ea1518bf27ed06d3496e89f1df4389e7a090dde29f5a986e16d7ad62151a52d41d178ca1adeccb05dcd2b0da37e169746ffcfb8122d2285792325c45fe7966ec18a21250df39c24741a3223aa138111b7fba5e280445a6f668d2f9b69fbfd2276a4ad09a21cd5ab258f9ac5fa916e593894f47aaed544168db11d8680a88afc1f9313052403a6484bf197a6eefde76d0ad2ead6d27a2e6568c040a181b24fb6d5b216ed10fe92cf43468247a6e527'
          resources:
            requests:
              memory: '640M'
              cpu: '100m'
            limits:
              memory: '1000M'
              cpu: '1000m'
---
apiVersion: v1
kind: Service
metadata:
  name: graphql-gateway
  namespace: dev
  labels:
    app: codyslexia
    component: graphql-gateway
spec:
  selector:
    app: codyslexia
    component: graphql-gateway
  ports:
    - name: graphql-gateway
      protocol: TCP
      port: 80
      targetPort: graphql-gateway
